- name: "Retrieve {{ region }} kubeconfig from vault"
  set_fact:
    vault_lookup: "{{ lookup('vault', kubeconfig_path) }}"
  vars:
    kubeconfig_path: "secret/ansible/common/kubeconfigs/{{ region | lower }}:kubeconfig"

- set_fact:
    kubeconfig: "{{ vault_lookup.kubeconfig.data.value | b64decode }}"
