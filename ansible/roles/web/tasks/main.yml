- name: Install Nginx
  package:
    name: nginx
    state: present
  become: yes

- name: Install Nginx Config
  template:
    src: "{{ nginx_config_template }}"
    dest: /etc/nginx/sites-available/default
    mode: 0644
  become: yes
  when: nginx_config_template is defined

- name: Start Nginx
  service:
    name: nginx
    state: started
  become: yes

- name: Add Certbot PPA
  apt_repository:
    repo: ppa:certbot/certbot
  become: yes

- name: Install Certbot
  package:
    name: python-certbot-nginx
    state: latest
  become: yes
