##
description: run auto-prov test. Assumes edge-cloud objects already present

tests:
  - name: find cloudlet for auto-prov app (1 of 3)
    apifile: "{{datadir2}}/find_cloudlet_ap.yml"
    actions: [dmeapi-findcloudlet]
  - name: find cloudlet for auto-prov app (2 of 3)
    apifile: "{{datadir2}}/find_cloudlet_ap.yml"
    actions: [dmeapi-findcloudlet]
  - name: find cloudlet for auto-prov app (3 of 3)
    apifile: "{{datadir2}}/find_cloudlet_ap.yml"
    actions: [dmeapi-findcloudlet]
  - name: sleep, allow extra time for auto-prov to create AppInst
    actions: [sleep=1]
  - name: check that AppInst was auto-provisioned
    actions: [mcapi-showfiltered]
    apifile: '{{datadir2}}/autoprov_appinst.yml'
    curuserfile: '{{datadir2}}/mc_user2.yml'
    compareyaml:
      yaml1: '{{outputdir}}/show-commands.yml'
      yaml2: '{{datadir2}}/autoprov_appinst_show.yml'
      filetype: mcdata
  - name: delete auto-provisioned AppInst
    actions: [mcapi-delete]
    apifile: '{{datadir2}}/autoprov_appinst.yml'
    curuserfile: '{{datadir2}}/mc_user2.yml'
