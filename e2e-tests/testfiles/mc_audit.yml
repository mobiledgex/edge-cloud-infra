description: check audit logs from jaeger
tests:
- name: verify audit logs by admin for all commands
  actions: [mcapi-auditorg]
  curuserfile: '{{datadir2}}/mc_admin.yml'
  apifile: '{{datadir2}}/mc_auditquery_limit10.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_all.yml'
    filetype: mcaudit
- name: verify audit logs by admin for org
  actions: [mcapi-auditorg]
  curuserfile: '{{datadir2}}/mc_admin.yml'
  apifile: '{{datadir2}}/mc_auditquery_org.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_org.yml'
    filetype: mcaudit
- name: verify audit logs by admin for self
  actions: [mcapi-auditself]
  curuserfile: '{{datadir2}}/mc_admin.yml'
  apifile: '{{datadir2}}/mc_auditquery_limit10.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_admin.yml'
    filetype: mcaudit
- name: verify audit logs by user2 for self
  actions: [mcapi-auditself]
  curuserfile: '{{datadir2}}/mc_user2.yml'
  apifile: '{{datadir2}}/mc_auditquery_limit10.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_user2.yml'
    filetype: mcaudit
- name: verify audit logs by user2 for org
  actions: [mcapi-auditself]
  curuserfile: '{{datadir2}}/mc_user2.yml'
  apifile: '{{datadir2}}/mc_auditquery_org.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_user2org.yml'
    filetype: mcaudit
- name: filter audit logs by operation
  actions: [mcapi-auditself]
  curuserfile: '{{datadir2}}/mc_user2.yml'
  apifile: '{{datadir2}}/mc_auditquery_oper.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_user2oper.yml'
    filetype: mcaudit
- name: filter audit logs by tag
  actions: [mcapi-auditorg]
  curuserfile: '{{datadir2}}/mc_admin.yml'
  apifile: '{{datadir2}}/mc_auditquery_tags.yml'
  compareyaml:
    yaml1: '{{outputdir}}/show-commands.yml'
    yaml2: '{{datadir2}}/mc_showaudit_tags.yml'
    filetype: mcaudit
